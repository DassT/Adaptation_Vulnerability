---
title: "hurdle models"
author: "Tim Dass"
date: "2024-07-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
install.packages("texreg")
```

## Setup

```{r setup}
library(mhurdle)
library(tidyverse)
library(texreg)
```
```{r}
df <- read.csv2("training", sep = ",")
head(df)
```

## Including Plots


```{r}
df_cragg <- df[, c("Contribution.per.Capita", "colony", "log_Exports", "log_Population", "log_dist", "ND_Vulnerability")]
df_cragg <- na.omit(df_cragg)
df_cragg <- df_cragg %>% mutate_if(is.character,as.numeric)
str(df_cragg)
```


```{r model, echo=FALSE}
cragg_model <- mhurdle(Contribution.per.Capita ~ 1 + log_Population + colony + log_dist + log_Exports + ND_Vulnerability | 1 + log_Population + colony + log_dist + log_Exports + ND_Vulnerability, df_cragg, dist = "l", scaled = FALSE, corr = FALSE, h2 = FALSE)
print(summary(cragg_model))
```
```{r}
texreg(cragg_model, type = "latex", title = "Cragg Model Results", label = "tab:Cragg_simple"
       , include.pvalues = TRUE, include.se = TRUE, single.row = TRUE)
```
```{r}
df_cragg <- df[, c('Contribution.per.Capita','log_Population', 'colony', 'log_dist', 'log_Exports', 'ND_Exposure', 'ND_Sensitivity', 'ND_Governance', 'ND_Adaptive.Capacity', 'ND_Vulnerability')]
df_cragg <- df_cragg %>% mutate_if(is.character,as.numeric)
df_cragg$ND_Governance2 <- df_cragg$ND_Governance ** 2
df_cragg <- na.omit(df_cragg)
str(df_cragg)
```
```{r}
cragg_model2 <- mhurdle(Contribution.per.Capita ~ 1 + log_Population + colony + log_dist + log_Exports + ND_Exposure + ND_Sensitivity + ND_Adaptive.Capacity + ND_Governance + ND_Governance2 | 1 + log_Population + colony + log_dist + log_Exports + ND_Exposure + ND_Sensitivity + ND_Adaptive.Capacity + ND_Governance + ND_Governance2, df_cragg, dist = "l", scaled = FALSE, corr = FALSE, h2 = FALSE)
print(summary(cragg_model2))
```

```{r}
cragg_model_simplified <- mhurdle(Contribution.per.Capita ~ 1 + log_Population + colony + log_dist + log_Exports | 1 + log_Population + colony + log_dist + log_Exports , df_cragg, dist = "l", scaled = FALSE, corr = FALSE, h2 = FALSE)
vuongtest(cragg_model,cragg_model_simplified, type = "nested")
```
```{r}
vuongtest(cragg_model, cragg_model2, type = "overlapping")
```

